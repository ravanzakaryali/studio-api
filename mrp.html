<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
</head>

<body>
    <div style="display:flex" id="hours">

    </div>
    <div style="display:flex" id="container">


    </div>
    <script>

        let data = [
            {
                name: 'P102',
                start: '09:00',
                end: "12:00"
            },
            {
                name: 'P103',
                start: '13:00',
                end: "14:00"
            },
            {
                name: 'P104',
                start: '16:00',
                end: "20:30"
            }
        ]
        let hours = [];

        for (let index = 9; index <= 21; index++) {
            hours.push(index + ":00")
        }





        let design = [];

        let startDay = moment('09:00', 'hh:mm');
        let endDay = moment('21:00', 'hh:mm');

        let lastHour = '';
        for (let index = 0; index < data.length; index++) {
            let classStartHour = moment(data[index].start, 'hh:mm');
            let classEndHour = moment(data[index].end, 'hh:mm');


            if (index == 0) {
                let difference = classStartHour.diff(startDay, 'hours', true)

                if (difference > 0) {
                    let designItem = {
                        name: 'Empty',
                        distance: difference
                    };

                    design.push(designItem);
                }

                let distance = classEndHour.diff(classStartHour, 'hours', true)

                let designItem2 = {
                    name: data[index].name,
                    distance: distance
                }

                design.push(designItem2);

                lastHour = classEndHour;

            }

            else {
                let distance = classStartHour.diff(lastHour, 'hours', true);

                if (distance > 0) {
                    let designItem = {
                        name: "EMPTY",
                        distance: distance
                    }
                    design.push(designItem);
                }

                let distance2 = classEndHour.diff(classStartHour, 'hours', true)
                console.log('distance', distance2);
                let designItem2 = {
                    name: data[index].name,
                    distance: distance2
                }

                design.push(designItem2);

                lastHour = classEndHour;

            }


        }


        design.forEach(element => {

            var randomColor = Math.floor(Math.random() * 16777215).toString(16);


            let divElement = document.createElement('div');
            divElement.innerHTML = element.name;
            divElement.style.height = "100px";
            divElement.style.width = (100 / 13) * element.distance + "%"

            if (element.name == 'EMPTY')
                divElement.style.backgroundColor = "#FFF";
            else
                divElement.style.backgroundColor = "#" + randomColor;

            document.getElementById('container').appendChild(divElement)
        });




        for (let index = 0; index < hours.length; index++) {

            let div = document.createElement('div');
            div.innerHTML = hours[index];

            div.style.width = (100 / 13) + '%'




            document.getElementById('hours').appendChild(div)

        }

    </script>
</body>


</html>